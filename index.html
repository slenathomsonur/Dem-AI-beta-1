<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dem AI - Your Customizable Assistant</title>
    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --dark-color: #121212;
            --light-color: #f8f9fa;
            --gray-color: #e9ecef;
            --text-color: #333;
            --text-light: #f8f9fa;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            color: var(--text-light);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: bold;
        }

        .logo-icon {
            background-color: var(--text-light);
            color: var(--primary-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }

        nav a {
            color: var(--text-light);
            text-decoration: none;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        nav a:hover, nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .main-content {
            display: flex;
            gap: 20px;
            flex: 1;
            margin: 20px 0;
        }

        .sidebar {
            width: 300px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }

        .chat-container {
            flex: 1;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .chat-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .chat-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-secondary {
            background-color: var(--gray-color);
            color: var(--text-color);
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 15px;
            border-radius: 15px;
            position: relative;
        }

        .user-message {
            align-self: flex-end;
            background-color: var(--primary-color);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .ai-message {
            align-self: flex-start;
            background-color: var(--gray-color);
            border-bottom-left-radius: 5px;
        }

        .message-time {
            font-size: 0.7rem;
            opacity: 0.7;
            margin-top: 5px;
            text-align: right;
        }

        .chat-input {
            padding: 20px;
            border-top: 1px solid var(--gray-color);
            display: flex;
            gap: 10px;
        }

        .chat-input textarea {
            flex: 1;
            padding: 15px;
            border: 1px solid var(--gray-color);
            border-radius: 20px;
            resize: none;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(106, 17, 203, 0.2);
        }

        .send-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            background-color: var(--secondary-color);
            transform: scale(1.05);
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .feature-card {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .conversation-item {
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .conversation-item:hover {
            background-color: var(--gray-color);
        }

        .conversation-item.active {
            background-color: var(--primary-color);
            color: white;
        }

        .conversation-actions {
            display: flex;
            gap: 5px;
        }

        .conversation-actions button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            opacity: 0.7;
            transition: all 0.3s ease;
        }

        .conversation-actions button:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        footer {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
            margin-top: auto;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 10px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary-color);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-color);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(106, 17, 203, 0.2);
            outline: none;
        }

        .conversation-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .message {
                max-width: 90%;
            }
            
            nav ul {
                display: none;
            }
            
            .mobile-menu {
                display: block;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">D</div>
                <span id="ai-name-display">Dem AI</span>
            </div>
            <nav>
                <ul>
                    <li><a href="#" class="active">Home</a></li>
                    <li><a href="#" id="settings-btn">Settings</a></li>
                    <li><a href="#">Pricing</a></li>
                    <li><a href="#">About</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </nav>
        </header>

        <div class="main-content">
            <div class="sidebar">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3>Conversations</h3>
                    <button class="btn btn-success" id="new-conversation-btn">
                        <span>+ New</span>
                    </button>
                </div>
                <div class="conversation-list" id="conversation-list">
                    <!-- Conversations will be dynamically added here -->
                </div>
                
                <div class="features">
                    <div class="feature-card" id="feature-write">
                        <div class="feature-icon">‚úçÔ∏è</div>
                        <div>Creative Writing</div>
                    </div>
                    <div class="feature-card" id="feature-code">
                        <div class="feature-icon">üíª</div>
                        <div>Code Assistant</div>
                    </div>
                    <div class="feature-card" id="feature-research">
                        <div class="feature-icon">üîç</div>
                        <div>Research</div>
                    </div>
                    <div class="feature-card" id="feature-brainstorm">
                        <div class="feature-icon">üí°</div>
                        <div>Brainstorming</div>
                    </div>
                </div>
            </div>

            <div class="chat-container">
                <div class="chat-header">
                    <div class="chat-title" id="current-conversation-title">Select a conversation</div>
                    <div class="chat-actions">
                        <button class="btn btn-secondary" id="clear-chat">
                            <span>Clear Chat</span>
                        </button>
                        <button class="btn btn-primary" id="new-chat">
                            <span>New Chat</span>
                        </button>
                    </div>
                </div>
                
                <div class="chat-messages" id="chat-messages">
                    <div class="message ai-message">
                        <div>Welcome to Dem AI! Please select a conversation from the sidebar or create a new one to get started.</div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
                
                <div class="chat-input">
                    <textarea id="message-input" placeholder="Type your message here..." rows="1" disabled></textarea>
                    <button class="send-btn" id="send-btn" disabled>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22 2L11 13" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <footer>
            <p>&copy; 2023 Dem AI. All rights reserved. Your privacy is important to us.</p>
        </footer>
    </div>

    <!-- New Conversation Modal -->
    <div class="modal" id="new-conversation-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create New Conversation</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-group">
                <label for="conversation-name">Conversation Name</label>
                <input type="text" id="conversation-name" class="form-control" placeholder="Enter conversation name">
            </div>
            <div class="form-group">
                <label for="conversation-topic">Topic (Optional)</label>
                <input type="text" id="conversation-topic" class="form-control" placeholder="Enter topic">
            </div>
            <button class="btn btn-primary" id="create-conversation-btn" style="width: 100%;">Create Conversation</button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">AI Settings</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-group">
                <label for="ai-name">AI Name</label>
                <input type="text" id="ai-name" class="form-control" placeholder="Enter AI name" value="Dem AI">
            </div>
            <div class="form-group">
                <label for="ai-personality">AI Personality</label>
                <select id="ai-personality" class="form-control">
                    <option value="friendly">Friendly</option>
                    <option value="professional">Professional</option>
                    <option value="humorous">Humorous</option>
                    <option value="formal">Formal</option>
                </select>
            </div>
            <button class="btn btn-primary" id="save-settings-btn" style="width: 100%;">Save Settings</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const chatMessages = document.getElementById('chat-messages');
            const messageInput = document.getElementById('message-input');
            const sendBtn = document.getElementById('send-btn');
            const clearChatBtn = document.getElementById('clear-chat');
            const newChatBtn = document.getElementById('new-chat');
            const newConversationBtn = document.getElementById('new-conversation-btn');
            const createConversationBtn = document.getElementById('create-conversation-btn');
            const saveSettingsBtn = document.getElementById('save-settings-btn');
            const settingsBtn = document.getElementById('settings-btn');
            const conversationList = document.getElementById('conversation-list');
            const currentConversationTitle = document.getElementById('current-conversation-title');
            const aiNameDisplay = document.getElementById('ai-name-display');
            
            // Modal Elements
            const newConversationModal = document.getElementById('new-conversation-modal');
            const settingsModal = document.getElementById('settings-modal');
            const closeModalButtons = document.querySelectorAll('.close-modal');
            
            // State
            let conversations = [];
            let currentConversationId = null;
            let aiName = "Dem AI";
            let aiPersonality = "friendly";
            
            // Initialize with a default conversation
            initializeDefaultConversation();
            
            // Auto-resize textarea
            messageInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });
            
            // Send message function
            function sendMessage() {
                const message = messageInput.value.trim();
                if (message === '') return;
                
                // Add user message
                addMessage(message, 'user');
                messageInput.value = '';
                messageInput.style.height = 'auto';
                
                // Update conversation in storage
                updateConversation(currentConversationId, message, 'user');
                
                // Show typing indicator
                showTypingIndicator();
                
                // Simulate AI response after a delay
                setTimeout(() => {
                    removeTypingIndicator();
                    const response = generateAIResponse(message);
                    addMessage(response, 'ai');
                    
                    // Update conversation in storage
                    updateConversation(currentConversationId, response, 'ai');
                }, 1500);
            }
            
            // Add message to chat
            function addMessage(text, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}-message`;
                
                const messageText = document.createElement('div');
                messageText.textContent = text;
                messageDiv.appendChild(messageText);
                
                const messageTime = document.createElement('div');
                messageTime.className = 'message-time';
                messageTime.textContent = getCurrentTime();
                messageDiv.appendChild(messageTime);
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Show typing indicator
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.id = 'typing-indicator';
                
                typingDiv.innerHTML = `
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <span>${aiName} is typing...</span>
                `;
                
                chatMessages.appendChild(typingDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Remove typing indicator
            function removeTypingIndicator() {
                const typingIndicator = document.getElementById('typing-indicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }
            
            // Generate AI response based on user input
            function generateAIResponse(userMessage) {
                const lowerMessage = userMessage.toLowerCase();
                
                // Personality-based responses
                let greeting = "Hello!";
                let questionResponse = "That's an interesting question.";
                let thanksResponse = "You're welcome!";
                
                if (aiPersonality === "professional") {
                    greeting = "Greetings.";
                    questionResponse = "I appreciate your inquiry.";
                    thanksResponse = "You're most welcome.";
                } else if (aiPersonality === "humorous") {
                    greeting = "Hey there!";
                    questionResponse = "That's a fascinating question!";
                    thanksResponse = "No problemo!";
                } else if (aiPersonality === "formal") {
                    greeting = "Good day.";
                    questionResponse = "I find your question quite compelling.";
                    thanksResponse = "It is my pleasure to assist you.";
                }
                
                if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                    return `${greeting} I'm ${aiName}. How can I assist you today?`;
                } else if (lowerMessage.includes('how are you')) {
                    return `I'm functioning optimally, thank you for asking. How can I help you today?`;
                } else if (lowerMessage.includes('thank')) {
                    return `${thanksResponse} Is there anything else I can help with?`;
                } else if (lowerMessage.includes('weather')) {
                    return "I don't have access to real-time weather data, but I can help you find weather information if you tell me your location!";
                } else if (lowerMessage.includes('joke')) {
                    const jokes = [
                        "Why don't scientists trust atoms? Because they make up everything!",
                        "Why did the scarecrow win an award? Because he was outstanding in his field!",
                        "Why don't skeletons fight each other? They don't have the guts!",
                        "What do you call a fake noodle? An impasta!"
                    ];
                    return jokes[Math.floor(Math.random() * jokes.length)];
                } else if (lowerMessage.includes('time')) {
                    return `The current time is ${new Date().toLocaleTimeString()}.`;
                } else if (lowerMessage.includes('name')) {
                    return `I'm ${aiName}, your intelligent assistant!`;
                } else if (lowerMessage.includes('help')) {
                    return "I can help with various tasks like answering questions, creative writing, coding assistance, research, and brainstorming. Just let me know what you need!";
                } else {
                    return `${questionResponse} I'm designed to assist with a wide range of topics. Could you provide more details so I can give you a better answer?`;
                }
            }
            
            // Get current time in HH:MM format
            function getCurrentTime() {
                const now = new Date();
                return now.getHours().toString().padStart(2, '0') + ':' + 
                       now.getMinutes().toString().padStart(2, '0');
            }
            
            // Clear chat function
            function clearChat() {
                if (!currentConversationId) return;
                
                chatMessages.innerHTML = '';
                addMessage(`Hello! I'm ${aiName}, your intelligent assistant. How can I help you today?`, 'ai');
                
                // Update conversation in storage
                const conversation = conversations.find(c => c.id === currentConversationId);
                if (conversation) {
                    conversation.messages = [
                        { text: `Hello! I'm ${aiName}, your intelligent assistant. How can I help you today?`, sender: 'ai', time: getCurrentTime() }
                    ];
                    saveConversations();
                }
            }
            
            // New chat function
            function newChat() {
                // Open new conversation modal
                newConversationModal.style.display = 'flex';
            }
            
            // Create a new conversation
            function createNewConversation() {
                const nameInput = document.getElementById('conversation-name');
                const topicInput = document.getElementById('conversation-topic');
                
                const name = nameInput.value.trim();
                const topic = topicInput.value.trim();
                
                if (name === '') {
                    alert('Please enter a conversation name');
                    return;
                }
                
                const newConversation = {
                    id: Date.now().toString(),
                    name: name,
                    topic: topic,
                    createdAt: new Date().toISOString(),
                    messages: [
                        { text: `Hello! I'm ${aiName}, your intelligent assistant. How can I help you today?`, sender: 'ai', time: getCurrentTime() }
                    ]
                };
                
                conversations.push(newConversation);
                saveConversations();
                renderConversations();
                
                // Switch to the new conversation
                switchConversation(newConversation.id);
                
                // Close modal and reset form
                newConversationModal.style.display = 'none';
                nameInput.value = '';
                topicInput.value = '';
            }
            
            // Switch to a conversation
            function switchConversation(conversationId) {
                currentConversationId = conversationId;
                const conversation = conversations.find(c => c.id === conversationId);
                
                if (conversation) {
                    // Update UI
                    currentConversationTitle.textContent = conversation.name;
                    chatMessages.innerHTML = '';
                    
                    // Enable input
                    messageInput.disabled = false;
                    sendBtn.disabled = false;
                    
                    // Load messages
                    conversation.messages.forEach(msg => {
                        addMessage(msg.text, msg.sender);
                    });
                    
                    // Update active state in conversation list
                    document.querySelectorAll('.conversation-item').forEach(item => {
                        item.classList.remove('active');
                        if (item.dataset.id === conversationId) {
                            item.classList.add('active');
                        }
                    });
                }
            }
            
            // Delete a conversation
            function deleteConversation(conversationId) {
                if (conversations.length <= 1) {
                    alert('You need to have at least one conversation');
                    return;
                }
                
                if (confirm('Are you sure you want to delete this conversation?')) {
                    conversations = conversations.filter(c => c.id !== conversationId);
                    saveConversations();
                    renderConversations();
                    
                    // If we deleted the current conversation, switch to the first one
                    if (currentConversationId === conversationId) {
                        if (conversations.length > 0) {
                            switchConversation(conversations[0].id);
                        } else {
                            // No conversations left, create a default one
                            initializeDefaultConversation();
                        }
                    }
                }
            }
            
            // Update conversation with new message
            function updateConversation(conversationId, message, sender) {
                const conversation = conversations.find(c => c.id === conversationId);
                if (conversation) {
                    conversation.messages.push({
                        text: message,
                        sender: sender,
                        time: getCurrentTime()
                    });
                    saveConversations();
                }
            }
            
            // Render conversations list
            function renderConversations() {
                conversationList.innerHTML = '';
                
                conversations.forEach(conversation => {
                    const conversationItem = document.createElement('div');
                    conversationItem.className = `conversation-item ${conversation.id === currentConversationId ? 'active' : ''}`;
                    conversationItem.dataset.id = conversation.id;
                    
                    const conversationInfo = document.createElement('div');
                    conversationInfo.innerHTML = `
                        <div>${conversation.name}</div>
                        <small>${formatDate(conversation.createdAt)}</small>
                    `;
                    
                    const conversationActions = document.createElement('div');
                    conversationActions.className = 'conversation-actions';
                    conversationActions.innerHTML = `
                        <button class="delete-conversation" title="Delete conversation">üóëÔ∏è</button>
                    `;
                    
                    conversationItem.appendChild(conversationInfo);
                    conversationItem.appendChild(conversationActions);
                    conversationList.appendChild(conversationItem);
                    
                    // Add event listeners
                    conversationItem.addEventListener('click', (e) => {
                        if (!e.target.classList.contains('delete-conversation')) {
                            switchConversation(conversation.id);
                        }
                    });
                    
                    const deleteBtn = conversationItem.querySelector('.delete-conversation');
                    deleteBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        deleteConversation(conversation.id);
                    });
                });
            }
            
            // Format date for display
            function formatDate(dateString) {
                const date = new Date(dateString);
                const now = new Date();
                const diffTime = Math.abs(now - date);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays === 1) {
                    return 'Today';
                } else if (diffDays === 2) {
                    return 'Yesterday';
                } else if (diffDays <= 7) {
                    return `${diffDays - 1} days ago`;
                } else {
                    return date.toLocaleDateString();
                }
            }
            
            // Save conversations to localStorage
            function saveConversations() {
                localStorage.setItem('dem-ai-conversations', JSON.stringify(conversations));
            }
            
            // Load conversations from localStorage
            function loadConversations() {
                const saved = localStorage.getItem('dem-ai-conversations');
                if (saved) {
                    conversations = JSON.parse(saved);
                }
            }
            
            // Save settings to localStorage
            function saveSettings() {
                localStorage.setItem('dem-ai-settings', JSON.stringify({
                    name: aiName,
                    personality: aiPersonality
                }));
            }
            
            // Load settings from localStorage
            function loadSettings() {
                const saved = localStorage.getItem('dem-ai-settings');
                if (saved) {
                    const settings = JSON.parse(saved);
                    aiName = settings.name || "Dem AI";
                    aiPersonality = settings.personality || "friendly";
                    
                    // Update UI
                    aiNameDisplay.textContent = aiName;
                    document.getElementById('ai-name').value = aiName;
                    document.getElementById('ai-personality').value = aiPersonality;
                }
            }
            
            // Initialize with a default conversation
            function initializeDefaultConversation() {
                loadConversations();
                loadSettings();
                
                if (conversations.length === 0) {
                    conversations = [{
                        id: 'default',
                        name: 'Welcome Chat',
                        topic: 'General',
                        createdAt: new Date().toISOString(),
                        messages: [
                            { text: `Hello! I'm ${aiName}, your intelligent assistant. How can I help you today?`, sender: 'ai', time: getCurrentTime() }
                        ]
                    }];
                    saveConversations();
                }
                
                renderConversations();
                
                // Set the first conversation as active
                if (conversations.length > 0 && !currentConversationId) {
                    switchConversation(conversations[0].id);
                }
            }
            
            // Event listeners
            sendBtn.addEventListener('click', sendMessage);
            
            messageInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            clearChatBtn.addEventListener('click', clearChat);
            newChatBtn.addEventListener('click', newChat);
            newConversationBtn.addEventListener('click', () => {
                newConversationModal.style.display = 'flex';
            });
            
            createConversationBtn.addEventListener('click', createNewConversation);
            
            settingsBtn.addEventListener('click', () => {
                settingsModal.style.display = 'flex';
            });
            
            saveSettingsBtn.addEventListener('click', () => {
                const newName = document.getElementById('ai-name').value.trim();
                const newPersonality = document.getElementById('ai-personality').value;
                
                if (newName === '') {
                    alert('Please enter an AI name');
                    return;
                }
                
                aiName = newName;
                aiPersonality = newPersonality;
                
                // Update UI
                aiNameDisplay.textContent = aiName;
                
                // Save settings
                saveSettings();
                
                // Close modal
                settingsModal.style.display = 'none';
                
                // Update welcome message in current conversation if it exists
                if (currentConversationId) {
                    const conversation = conversations.find(c => c.id === currentConversationId);
                    if (conversation && conversation.messages.length > 0 && 
                        conversation.messages[0].sender === 'ai' && 
                        conversation.messages[0].text.includes("I'm")) {
                        
                        conversation.messages[0].text = `Hello! I'm ${aiName}, your intelligent assistant. How can I help you today?`;
                        saveConversations();
                        
                        // Reload the conversation to reflect the change
                        switchConversation(currentConversationId);
                    }
                }
            });
            
            // Close modals when clicking the X button
            closeModalButtons.forEach(button => {
                button.addEventListener('click', () => {
                    newConversationModal.style.display = 'none';
                    settingsModal.style.display = 'none';
                });
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === newConversationModal) {
                    newConversationModal.style.display = 'none';
                }
                if (e.target === settingsModal) {
                    settingsModal.style.display = 'none';
                }
            });
            
            // Feature cards click event
            document.querySelectorAll('.feature-card').forEach(card => {
                card.addEventListener('click', function() {
                    if (!currentConversationId) return;
                    
                    const featureName = this.querySelector('div:last-child').textContent;
                    
                    // Add a message about the selected feature
                    addMessage(`You've selected the ${featureName} feature. How can I assist you with this?`, 'ai');
                    
                    // Update conversation in storage
                    updateConversation(currentConversationId, `You've selected the ${featureName} feature. How can I assist you with this?`, 'ai');
                    
                    // Scroll to the input
                    messageInput.focus();
                });
            });
        });
    </script>
</body>
</html>
